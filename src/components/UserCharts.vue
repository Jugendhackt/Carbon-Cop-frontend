<template>
	<v-container>
		<h2>Your Stats</h2>

		<v-row>
			<v-col cols="12" sm="12" lg="6">
				<column-chart
					:data="meansStats"
					xtitle="Means of transportation"
					ytitle="km"
				></column-chart>
			</v-col>
			<v-col cols="12" sm="12" lg="6">
				<div class="world-pie">
					<div class="svg-container">
						<div
							class="ring"
							:style="{ backgroundImage: `url(${gradient})` }"
						/>
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 67.73 67.73">
							<path
								d="M28.75 67.54a36.5 36.5 0 0 1-16.37-7.33A36.01 36.01 0 0 1 .81 42.3c-.73-2.74-.8-3.55-.81-8.47 0-4.95.07-5.72.8-8.4A35.3 35.3 0 0 1 13.57 6.48 40.9 40.9 0 0 1 25.4.8C28.14.07 28.92 0 33.87 0c4.94 0 5.73.08 8.48.8 6.38 1.7 13.43 6.1 17.33 10.83 2.05 2.49 2.15 2.69 1.23 2.5-.61-.14-.63-.11-.17.18.3.2.67.26.83.17.73-.46 4.22 6.66 5.37 10.95.72 2.67.8 3.48.8 8.4 0 4.93-.08 5.73-.81 8.47a39.24 39.24 0 0 1-2.62 6.65A33.03 33.03 0 0 1 49 64.23c-5.04 2.52-8.36 3.34-14.08 3.48a48.4 48.4 0 0 1-6.18-.17zm9.06-.32a33.96 33.96 0 0 0 22.84-13A35.2 35.2 0 0 0 67.37 37c.33-3.07.32-3.36-.19-3.92-.4-.44-.76-.55-1.33-.4-1.07.26-3.34 2.23-3.36 2.9-.02 1.36-1.51 3.57-1.52 2.26a11 11 0 0 0-.93-2.2c-.5-1-.86-2.05-.78-2.35.11-.42.02-.5-.44-.36-.39.12-.58.04-.58-.26 0-.73-1.26-1.33-2.5-1.18-.73.09-1.4-.04-1.87-.35-.4-.26-.93-.4-1.17-.32-.23.1-.86-.2-1.4-.64-1.26-1.07-1.53-.73-.49.63.77 1 .88 1.05 1.48.66.4-.26.78-.32.96-.16.16.15.54.44.84.64.5.34.47.44-.38 1.47a6.95 6.95 0 0 1-3.02 1.93c-2.3.91-3.04.84-3.04-.28 0-.4-.31-1.13-.7-1.6-.37-.47-.95-1.37-1.28-2.01-.63-1.22-.98-1.58-1.26-1.3-.21.2 2.19 4.68 2.96 5.5.32.35.58.8.58 1.02 0 .4.54.36 2.35-.16 1.62-.46.25 2.29-2.28 4.56-1.31 1.18-1.59 1.6-1.59 2.44 0 .55.14 1.1.3 1.2.34.2.41 1.65.12 2.4-.1.27-.58.7-1.06.94-.7.37-.87.65-.87 1.51 0 .67-.17 1.13-.45 1.24-.25.1-.46.4-.46.68s-.54 1.04-1.2 1.68c-1.03 1.01-1.43 1.2-2.86 1.31-1.62.14-1.67.12-1.88-.73a7.79 7.79 0 0 0-.77-1.77c-.3-.5-.55-1.15-.55-1.43 0-.29-.3-1.15-.68-1.91-.64-1.32-.65-1.44-.18-2.26.36-.62.43-1.15.27-1.89-.25-1.1-1.15-2.65-1.54-2.65-.13 0-.12-.5.02-1.11.3-1.34.18-1.6-.63-1.39-.4.1-.77-.04-1.04-.4-.36-.5-.53-.52-1.44-.2a7.5 7.5 0 0 1-2.12.38c-.6 0-1.15.17-1.22.38-.07.22-.9-.4-2.03-1.5-1.7-1.68-1.88-1.98-1.68-2.73.12-.46.21-1.3.2-1.87a3.9 3.9 0 0 1 1.63-3.23c.4-.27.75-.69.75-.93 0-.65 1.5-1.92 2.27-1.92.38 0 1.17-.2 1.77-.45 1.34-.56 4.11-.61 4.18-.07l.08.77c.01.22.68.69 1.47 1.03 1.31.57 1.49.58 1.97.15.45-.41.85-.43 2.9-.14 2.2.3 2.43.29 2.8-.23.73-1 .51-1.36-.81-1.36-1.53 0-2.4-.44-2.4-1.22 0-.64-.23-.73-.87-.32-.3.19-.31.32-.06.47.27.17.26.32 0 .65-.54.64-.85.52-1.37-.56-.42-.87-2.44-2.65-3.01-2.65-.4 0 .57.95 1.43 1.4.69.35.78.51.48.84-.3.32-.63.21-1.8-.61-1.19-.83-1.62-.98-2.44-.82-.55.1-1.1.38-1.23.6a.9.9 0 0 1-.7.4c-.24 0-.56.33-.71.73-.2.5-.59.76-1.28.87-1 .16-2.57-.33-2.44-.76.04-.13.07-.64.07-1.13 0-.89.04-.91 1.48-.91 1.99 0 2.38-.97.64-1.6-.29-.1-.1-.24.52-.38.98-.21 1.1-.85.13-.7-.82.14-1.35-.32-.93-.83.28-.33.2-.55-.37-1.02-.61-.51-.65-.65-.26-.9.76-.51 1.51-.36 1.8.36.14.38.6 1 1 1.38.75.7.77.7 1.79.15 1.01-.54 1.16-.71 1.16-1.3 0-.17.2-.3.46-.3.25 0 .45.18.45.41 0 .94 3.5.8 3.8-.14.1-.32.45-.58.78-.58s.52-.12.43-.28c-.1-.16.4-.34 1.12-.4 1.27-.12 1.26-.12-.27-.17-1.88-.06-2.28-.64-1.08-1.54.73-.55.76-.61.21-.62-.33 0-.77.26-.98.6-.21.33-.58.6-.83.6s-.45.13-.45.3c0 .17.13.3.3.3.97 0-.61 1.77-1.8 2.01-.8.16-.93.1-.93-.45s-.12-.6-.94-.45c-.64.13-1.02.06-1.2-.23-.54-.85-.28-1.42.86-1.88A7.6 7.6 0 0 0 36.29 15c1.55-1.5 4.58-1.96 7.7-1.15.93.24 2.07.51 2.53.61.47.1.77.3.68.45-.1.16.1.26.42.23a.87.87 0 0 0 .74-.58c.16-.64.8-.73.8-.12 0 .33.25.37 1.14.17 2.54-.55 5.45-.75 6.64-.46.7.18.76.15.4-.27-.21-.27-.34-.52-.28-.55.07-.04.42-.32.78-.62.95-.8 1.85-.2 1.67 1.12-.08.52-.29 1.04-.48 1.16-.24.17-.24.23.01.23.59 0 .99-.73.96-1.78-.06-2.11-5.72-7-11.23-9.7C38.23-1.42 26.44-.9 16.16 5.18l-1.37.8 1.67.26c.91.13 2.1.24 2.64.22.83-.02 1.04.13 1.4 1 .58 1.38.88 1.51 1.97.89.78-.45.99-.47 1.32-.12.3.32.3.45.03.55-.82.3-1.94 1.4-1.89 1.87.13 1.35-.04 1.85-.63 1.85-.44 0-.6.2-.6.75 0 .6-.22.8-1.14 1.05a8.8 8.8 0 0 1-1.6.32c-.27 0-.74.2-1.07.45a2.5 2.5 0 0 1-1.24.45c-.94.01-1.64.33-1.44.65.1.15-.05.35-.3.45-.27.1-.48.37-.48.6 0 .3-.3.39-.95.32-1.19-.13-3.09-1.9-2.88-2.68.08-.3.03-.54-.12-.54-.14 0-.42-.48-.63-1.06-.21-.58-.48-1.06-.6-1.06-.24 0-2.09 2.25-2.09 2.54 0 .1.28.18.6.18.34 0 .61.13.61.29 0 .36-1.11.71-1.5.47-.18-.1-.31-.05-.31.12 0 .16.17.4.37.53.26.16.15.29-.35.4-.8.19-1.5 1.06-1.14 1.41.12.13.45 0 .72-.27.47-.47.58-.43 1.61.47.61.53 1.47 1.22 1.91 1.53.64.46.74.68.5 1.14-.26.46-.2.57.27.57.32 0 .67.21.77.48.25.66.26.65-.5.57l-1.22-.1c-.44-.04-.48-.16-.23-.63.5-.92.39-.96-.81-.29-.72.4-1.16.52-1.24.3-.13-.39-1.16-.45-1.39-.08-.08.13.15.24.52.22.38 0 .63.14.59.36-.07.35.48.51 1.36.4.2-.03.38.14.38.37 0 .5-2.17 1.23-2.42.82-.3-.48-1.52.03-1.52.64 0 .35-.21.57-.55.57-.62 0-1.93 1.35-1.62 1.66.11.11-.04.38-.34.6-.73.53-1.1 3.42-.49 3.85.33.23.3.26-.13.12-.93-.3-.46.82.56 1.3.5.24.74.49.54.55-.2.07-.65-.03-1.02-.23-.65-.35-.65-.33-.53 1.8.15 2.73.5 3.1 1.82 1.99 1-.84 1-.84 1.1-.17.1.64.12.65.53.12.27-.35.5-.44.65-.24.13.17.94.3 1.8.29.87-.01 1.5.1 1.4.25-.23.39 1.45 1.7 2.2 1.7.35.01 1 .4 1.46.88l.82.86-.7.51-.69.5.69-.32c.54-.25.98-.19 2.08.3.77.34 1.56.62 1.77.62.6 0 2.3.94 2.47 1.36.17.45-.55 1.99-1.18 2.51-.24.2-.45.84-.47 1.43-.05 1.45-.71 2.29-2.23 2.85-.94.35-1.32.68-1.49 1.3-.33 1.22-2.41 3.31-3.12 3.13-.42-.11-.48-.06-.23.19.25.25.25.45 0 .75-.8.95 5.21 5.84 10.12 8.24a32.58 32.58 0 0 0 18.85 3.3zm10.57-16.34c-.12-.19-.24-1-.28-1.82-.06-1.25.03-1.54.57-1.83.35-.19.82-.6 1.04-.9 1.01-1.43 1.3.16.47 2.64-.7 2.12-1.29 2.74-1.8 1.91zm13.8-12.82c0-.41.14-.75.3-.75.17 0 .3.34.3.75 0 .42-.13.76-.3.76-.16 0-.3-.34-.3-.76zm-59.43-4c-.8-.2-.3-.69.7-.69.53 0 .9.16.9.4 0 .4-.65.51-1.6.29zm2.2-.08a.3.3 0 0 1 .6 0 .3.3 0 0 1-.6 0zm31.19-7.56c-.37-.24-.33-.3.2-.3.37 0 .76.13.86.3.24.38-.46.38-1.06 0zm-1.91-.8c-.1-.1-.12-.31-.03-.46.2-.31.73-.04.73.37 0 .32-.41.38-.7.09zm-7-4.58c-.4-.4-.12-1.25.46-1.44.74-.23 1.34.23 1.1.86-.18.45-1.28.87-1.57.58zm-5.1-4.83c-1.31-.65-.98-.93 1.07-.88 2.1.05 2.42.41.83.94-.84.28-1.23.27-1.9-.06zm29.53-2.8c-.38-.16-.68-.34-.68-.4 0-.08.71-.48 1.59-.9 1.85-.9 5.66-1.38 5.05-.64-.2.25-.91.43-1.67.43-1.77 0-2.92.54-2.69 1.26.2.62-.42.71-1.6.24zm-7.4 27.85c.07-.23-.04-.34-.27-.27a.95.95 0 0 0-.53.53c-.07.23.04.34.27.27a.95.95 0 0 0 .53-.53zM.75 38.6c-.26-.45-.32-.46-.33-.07-.01.51.3.97.52.76.07-.08-.01-.38-.19-.69zM52.04 26.2c-.12-.29-.24-.7-.28-.92a2.8 2.8 0 0 0-.58-.99c-.67-.78-.64-.89.25-.89.42 0 .76-.12.76-.27 0-.43-.98-.68-1.32-.34-.18.17-.63.31-1.01.31-.95 0-.89.72.13 1.52.76.6.79.68.31 1.03-.69.5-.12 1.08 1.07 1.08.72 0 .84-.1.67-.53zm-8.23-1.45c.57-.1 1.3-.07 1.6.09.32.16.88.2 1.25.1.66-.17.65-.2-.37-1.1-.93-.84-1.1-.89-1.5-.48-.4.4-.52.4-1.05-.08-.57-.51-.6-.5-1.13.3-.68 1.03-.8 1.74-.26 1.53.22-.09.88-.25 1.46-.36zm.05-7.4c-.1-.16-.32-.3-.49-.3-.17 0-.22.14-.11.3.1.17.32.3.49.3.16 0 .21-.13.11-.3zm2.79-1.7c.05-.16-.37-.3-.93-.3-.62 0-.99.14-.91.33.15.4 1.7.38 1.84-.03zm-36.39-2.2c-.1-.19-.33-.33-.5-.33-.16 0-.11.19.1.42.43.47.71.4.4-.1zm9.63.11c-.1-.26-.24-.4-.32-.32-.08.08-.05.29.05.46.3.49.48.4.27-.14z"
								fill="olive"
							/>
						</svg>
					</div>
				</div>
			</v-col>
		</v-row>
	</v-container>
</template>

<script>
import ConicGradient from '../conicGradient';

export default {
	data() {
		return { gradient: undefined, meansStats: [] };
	},
	async mounted() {
		const ratio = 1;
		const color1 = `rgb(255, 255, 255)`;
		const color2 = `rgb(212,0,0)`;
		this.gradient = new ConicGradient({
			stops: `${color2} ${30 * ratio}deg, ${color1} ${30 *
				ratio}deg, ${color1} ${60 * ratio}deg, ${color2} ${60 * ratio}deg`,
			repeating: true
		}).dataURL;

		const response = await fetch(
			`${process.env.VUE_APP_HOST}/stats?name=${this.$store.state.username}`
		);
		if (response.status === 200) {
			const data = await response.json();
			this.meansStats = Object.keys(data).map(key => [
				key[0].toUpperCase() + key.slice(1),
				data[key]
			]);
		}
	}
};
</script>

<style lang="scss" scoped>
.world-pie {
	text-align: center;

	.svg-container {
		display: inline-block;
		position: relative;
		border-radius: 50%;
		width: 100%;
		max-width: 200px;

		.ring {
			position: absolute;
			left: 0;
			right: 0;
			top: 0;
			bottom: 0;
			margin: -40px;
			box-shadow: 0 0 2px rgba(0, 0, 0, 0.3);
			border-radius: 50%;
			z-index: 0;
		}
	}

	svg {
		position: relative;
		width: 100%;
		z-index: 99;
		background: #fff;
		border-radius: 50%;
	}
}
</style>
